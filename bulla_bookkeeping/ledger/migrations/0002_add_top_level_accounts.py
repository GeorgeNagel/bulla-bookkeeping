# Generated by Django 5.1.4 on 2025-02-02 13:45

from django.db import migrations
from django_bulla.models.normals import Normals


def add_top_level_accounts(apps, schema_editor):
    Account = apps.get_model("ledger", "Account")
    if not Account.objects.filter(name="Dividends").exists():
        Account.objects.create(name="Dividends", normal=Normals.DEBIT)
    if not Account.objects.filter(name="Expenses").exists():
        Account.objects.create(name="Expenses", normal=Normals.DEBIT)
    if not Account.objects.filter(name="Assets").exists():
        Account.objects.create(name="Assets", normal=Normals.DEBIT)
    if not Account.objects.filter(name="Liabilities").exists():
        Account.objects.create(name="Liabilities", normal=Normals.CREDIT)
    if not Account.objects.filter(name="Equity").exists():
        Account.objects.create(name="Equity", normal=Normals.CREDIT)
    if not Account.objects.filter(name="Revenue").exists():
        Account.objects.create(name="Revenue", normal=Normals.CREDIT)


def remove_top_level_accounts(apps, schema_editor):
    Account = apps.get_model("ledger", "Account")
    if Account.objects.filter(name="Dividends").exists():
        Account.objects.filter(name="Dividends").delete()
    if Account.objects.filter(name="Expenses").exists():
        Account.objects.filter(name="Expenses").delete()
    if Account.objects.filter(name="Assets").exists():
        Account.objects.filter(name="Assets").delete()
    if Account.objects.filter(name="Liabilities").exists():
        Account.objects.filter(name="Liabilities").delete()
    if Account.objects.filter(name="Equity").exists():
        Account.objects.filter(name="Equity").delete()
    if Account.objects.filter(name="Revenue").exists():
        Account.objects.filter(name="Revenue").delete()


class Migration(migrations.Migration):

    dependencies = [
        ("ledger", "0001_initial"),
    ]

    operations = [
        migrations.RunPython(
            add_top_level_accounts, reverse_code=remove_top_level_accounts
        ),
    ]
